<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Elijah's Fabric Mod Downloader</title>

<style>
body {
  font-family: system-ui, sans-serif;
  background: #0f0f0f;
  color: #fff;
  padding: 20px;
}

header {
  display: flex;
  align-items: center;
  gap: 20px;
  margin-bottom: 20px;
}

select {
  padding: 6px 10px;
  font-size: 15px;
  background: #1b1b1b;
  color: white;
  border: 1px solid #333;
  border-radius: 6px;
}

#mods {
  display: grid;
  grid-template-columns: repeat(5, 1fr); /* exactly 4 columns */
  gap: 16px;
}


.mod {
  display: flex;
  gap: 14px;
  padding: 14px;
  background: #1b1b1b;
  border-radius: 12px;
  align-items: flex-start;
}

.mod-header {
  display: flex;
  gap: 14px;
  align-items: flex-start;
}

.mod img {
  width: 64px;
  height: 64px;
  border-radius: 10px;
  flex-shrink: 0;
}

.mod h2 {
  margin: 0;
  font-size: 18px;
}

.mod-description {
  font-size: 14px;
  color: #ccc;
  margin: 6px 0;
  flex-grow: 1; /* fill remaining space for uniformity */
}

.dependencies {
  font-size: 13px;
  color: #aaa;
  margin-bottom: 8px;
}

.mod-actions {
  margin-top: 4px;
}

.download {
  padding: 6px 12px;
  background: #1bd96a;
  border: none;
  border-radius: 6px;
  font-size: 14px;
  cursor: pointer;
  right: 0px;
}

.unavailable {
  padding: 6px 10px;
  background: #4a1f1f;
  color: #ff6b6b;
  border: 1px solid #7a2a2a;
  border-radius: 6px;
  font-size: 13px;
  text-align: center;
}
</style>
</head>

<body>

<header>
  <h1>Elijah's Fabric Mod Downloader</h1>
  <select id="mcVersion"></select>
    <p style="color: white;">Download the Fabric Modloader <a style="color: #1bd96a" href="https://maven.fabricmc.net/net/fabricmc/fabric-installer/1.1.0/fabric-installer-1.1.0.jar" target="_blank" rel="noopener noreferrer">Here</a></p>
    <p style="color: white;">Download Java 25 JDK <a style="color: #1bd96a" href="https://www.oracle.com/java/technologies/downloads/#jdk25-windows" target="_blank" rel="noopener noreferrer">Here</a></p>
</header>

<div id="mods"></div>

<script>
/* ===== CONFIG ===== */
const MODS = [
 "P7dR8mSH", /* Fabric API */
 "AANobbMI", /* Sodium */
 "PtjYWJkn", /* Sodium Extra */
 "Bh37bMuy", /* Reese's Sodium Options */
 "EIa1eiMm", /* Sodium Shadowy Path Blocks */
 "LQ3K71Q1", /* Dynamic FPS */
 "YL57xq9U", /* Iris */
 "1IjD5062", /* Continuity */
 "mOgUt4GM", /* Mod Menu */
 "DynYZEae", /* Exordium */
 "yBW8D80W", /* LambDynamicLights */
 "o7DitHWP", /* WI Zoom */
 "rI0hvYcd", /* Visuality */
 "WhbRG4iK", /* Falling Leaves */
 "NK39zBp2", /* Blur+ */
 "rcLriA4v", /* Amecs */
 "L4pt5egz", /* Locator Heads */
 "wdLuzzEP", /* Gamma Utils (Fullbright) */
 "zV5r3pPn", /* 3D Skin Layers */
 "PFwYNrHb", /* Armor Poser */
 "aC3cM3Vq", /* Mouse Tweaks */
 "h3XWIuzM", /* Dark Loading Screen */
 "qpPoAL6m", /* Trade Cycling */
 "2M01OLQq", /* Shulker Box Tooltip */
 "GNtptqqU", /* Map Tooltip */
 "2RKFTmiB", /* ToolTipFix */
 "1bokaNcj", /* Xaero's Minimap */
 "NcUtCpym", /* Xaero's World Map */
 "qyVF9oeo", /* Sound Physics Remastered */
 "xAZojC2l", /* ClipboardScreenshot */
 "smUP7V3r", /* Durability Tooltip */
 "4I1XuqiY", /* Entity Model Features */
 "9mtu0sUO", /* Fast IP Ping */
 "8qkXwOnk", /* More Chat History */
 "ETlrkaYF", /* Cubes Without Borders */
 "OB69KhRA", /* OrthoCamera */
 "rhyHyQke", /* Seamless */
 "3s19I5jr", /* Skin Shuffle */
 "Nv2fQJo5", /* Replay Mod */
 "TQTTVgYE", /* Carpet */
 "c7m1mi73", /* Packet Fixer */
 "d51fN9ny", /* FastOpenLinksAndFolders */
 "9eGKb6K1", /* Simple Voice Chat */
 "yI6ANuOK", /* Replay Voice Chat */
];

/* ===== ELEMENTS ===== */
const modsContainer = document.getElementById("mods");
const mcSelect = document.getElementById("mcVersion");

/* ===== STATE ===== */
const seenProjects = new Set();
const queue = [];

/* ===== INIT ===== */
init();

async function init() {
  await loadMinecraftVersions();
  mcSelect.addEventListener("change", loadMods);
  loadMods();
}

/* ===== FETCH MC VERSIONS ===== */
async function loadMinecraftVersions() {
  const versions = await fetch(
    "https://api.modrinth.com/v2/project/fabric-api/version"
  ).then(r => r.json());

  const mcVersions = new Set();

  versions.forEach(v =>
    v.game_versions.forEach(gv => {
      if (/^\d+\.\d+(\.\d+)?$/.test(gv)) mcVersions.add(gv);
    })
  );

  [...mcVersions]
    .sort((a, b) => b.localeCompare(a, undefined, { numeric: true }))
    .forEach(v => {
      const option = document.createElement("option");
      option.value = v;
      option.textContent = `Minecraft ${v}`;
      mcSelect.appendChild(option);
    });
}

/* ===== LOAD MODS + DEPENDENCIES ===== */
async function loadMods() {
  modsContainer.innerHTML = "";
  seenProjects.clear();
  queue.length = 0;

  queue.push(...MODS);

  while (queue.length) {
    const slug = queue.shift();
    if (seenProjects.has(slug)) continue;
    seenProjects.add(slug);

    const project = await fetch(
      `https://api.modrinth.com/v2/project/${slug}`
    ).then(r => r.json()).catch(() => null);

    if (!project) continue;

    const versions = await fetch(
      `https://api.modrinth.com/v2/project/${slug}/version`
    ).then(r => r.json());

    const mcVersion = mcSelect.value;

    const match = versions.find(v =>
      v.loaders.includes("fabric") &&
      v.game_versions.includes(mcVersion)
    );

    let dependencies = [];
    let downloadUrl = null;
    let description = project.description || "";

    if (match) {
      downloadUrl = match.files.find(f => f.primary)?.url || null;

      const required = match.dependencies
        .filter(d => d.dependency_type === "required")
        .map(d => d.project_id);

      for (const depId of required) {
        if (seenProjects.has(depId)) continue;

        const depProject = await fetch(
          `https://api.modrinth.com/v2/project/${depId}`
        ).then(r => r.json()).catch(() => null);

        if (depProject) {
          dependencies.push(depProject.title);
          queue.push(depProject.slug);
        }
      }
    }

    renderMod(project, downloadUrl, !!match, dependencies, description);
  }
}

/* ===== RENDER ===== */
function renderMod(project, downloadUrl, available, dependencies, description) {
  const div = document.createElement("div");
  div.className = "mod";

  div.innerHTML = `
    <div class="mod-header">
      <img src="${project.icon_url || ""}" alt="">
      <div>
        <h2>${project.title}</h2>
        <div class="mod-description">${description}</div>
        ${
          dependencies.length
            ? `<div class="dependencies">
                 Requires: ${dependencies.join(", ")}
               </div>`
            : ""
        }
      </div>
    </div>
    <div class="mod-actions">
      ${
        available
          ? `<button class="download" onclick="window.open('${downloadUrl}')">
               Download
             </button>`
          : `<div class="unavailable">
               No Fabric version for this Minecraft release
             </div>`
      }
    </div>
  `;

  modsContainer.appendChild(div);
}
</script>

</body>
</html>
